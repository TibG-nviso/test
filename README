# Define the output file
$evidenceFile = "evidence01.txt"

# Initialize the evidence file
"Office 2016 Macro Settings Report" | Out-File $evidenceFile
"Generated on: $(Get-Date)" | Out-File $evidenceFile -Append
"`n" | Out-File $evidenceFile -Append

# Define applications and settings
$applications = @("Access", "Excel", "Word", "PowerPoint", "Outlook")
$settings = @("BlockContentExecutionFromInternet", "VBAWarnings")

foreach ($app in $applications) {
    foreach ($setting in $settings) {
        $regPath = "HKCU:\Software\Policies\Microsoft\Office\16.0\$app\Security"
        try {
            $value = Get-ItemProperty -Path $regPath -Name $setting -ErrorAction Stop
            "${app} - ${setting}: $($value.$setting)" | Out-File $evidenceFile -Append
        }
        catch {
            "${app} - ${setting}: Not Set" | Out-File $evidenceFile -Append
        }
    }
    "`n" | Out-File $evidenceFile -Append
}

# Confirmation message
Write-Output "Registry values have been exported to $evidenceFile"
