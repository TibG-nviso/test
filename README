# Define registry paths and value names
$registryPaths = @{
    "Access_BlockContentExecutionFromInternet" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Access\Security\BlockContentExecutionFromInternet"
    "Excel_BlockContentExecutionFromInternet" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Excel\Security\BlockContentExecutionFromInternet"
    "Word_BlockContentExecutionFromInternet" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Word\Security\BlockContentExecutionFromInternet"
    "PowerPoint_BlockContentExecutionFromInternet" = "HKCU:\Software\Policies\Microsoft\Office\16.0\PowerPoint\Security\BlockContentExecutionFromInternet"
    "Outlook_BlockContentExecutionFromInternet" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Outlook\Security\BlockContentExecutionFromInternet"
    "Access_VBAWarnings" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Access\Security\VBAWarnings"
    "Excel_VBAWarnings" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Excel\Security\VBAWarnings"
    "Word_VBAWarnings" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Word\Security\VBAWarnings"
    "PowerPoint_VBAWarnings" = "HKCU:\Software\Policies\Microsoft\Office\16.0\PowerPoint\Security\VBAWarnings"
    "Outlook_VBAWarnings" = "HKCU:\Software\Policies\Microsoft\Office\16.0\Outlook\Security\VBAWarnings"
}

# Initialize the output file
$outputFile = "evidence01.txt"
Clear-Content -Path $outputFile

# Function to get registry value
function Get-RegistryValue {
    param (
        [string]$path
    )
    try {
        $value = Get-ItemProperty -Path $path -ErrorAction Stop
        return $value.PSObject.Properties.Value
    } catch {
        return "Not Found"
    }
}

# Query each registry path and write to the output file
foreach ($key in $registryPaths.Keys) {
    $value = Get-RegistryValue -path $registryPaths[$key]
    Add-Content -Path $outputFile -Value "$key: $value"
}

Write-Host "Registry values have been written to $outputFile"
